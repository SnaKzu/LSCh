# üåê LSP Web Application

Aplicaci√≥n web moderna para reconocimiento de Lengua de Se√±as Peruana en tiempo real.

![LSP Recognition](https://img.shields.io/badge/LSP-Recognition-blue)
![Python 3.10](https://img.shields.io/badge/Python-3.10-green)
![Flask](https://img.shields.io/badge/Flask-2.3.0-lightgrey)
![License](https://img.shields.io/badge/License-MIT-yellow)

---

## üìã Tabla de Contenidos

- [Caracter√≠sticas](#caracter√≠sticas)
- [Requisitos](#requisitos)
- [Instalaci√≥n](#instalaci√≥n)
- [Uso](#uso)
- [Estructura del Proyecto](#estructura-del-proyecto)
- [API Endpoints](#api-endpoints)
- [WebSocket Events](#websocket-events)
- [Personalizaci√≥n](#personalizaci√≥n)
- [Troubleshooting](#troubleshooting)

---

## ‚ú® Caracter√≠sticas

### Frontend
- üé® **Dise√±o Moderno** con animaciones CSS fluidas
- üì± **Responsive Design** compatible con m√≥viles y tablets
- üé• **WebRTC** para captura de video en tiempo real
- üîå **WebSocket** para comunicaci√≥n bidireccional instant√°nea
- üìä **Estad√≠sticas en Vivo** de predicciones y confianza
- üéØ **UI/UX Intuitiva** con feedback visual inmediato

### Backend
- ‚ö° **Flask + SocketIO** para servidor en tiempo real
- üß† **MediaPipe Integration** para detecci√≥n de pose/manos/rostro
- ü§ñ **Modelo LSTM** para clasificaci√≥n de se√±as
- üìà **API REST** para consultas de vocabulario y health check
- üîÑ **Gesti√≥n de Sesiones** m√∫ltiples usuarios simult√°neos
- üìù **Logging Completo** para debugging y monitoreo

---

## üì¶ Requisitos

### Sistema
- Python 3.10.0
- Navegador moderno con soporte para:
  - WebRTC (getUserMedia)
  - WebSocket
  - HTML5 Canvas
  - ES6 JavaScript

### Dependencias Python
```
flask>=2.3.0
flask-cors>=4.0.0
flask-socketio>=5.3.0
python-socketio>=5.9.0
tensorflow>=2.15.0
mediapipe>=0.10.11
opencv-python>=4.8.0
numpy>=1.24.0
```

---

## üöÄ Instalaci√≥n

### 1. Clonar el Repositorio
```bash
cd modelo_lstm_lsp-main
```

### 2. Instalar Dependencias
```powershell
# Instalar Flask y SocketIO
py -3.10 -m pip install flask flask-cors flask-socketio python-socketio --user

# Las dem√°s dependencias ya deber√≠an estar instaladas
# Si no, instalar desde requirements.txt
py -3.10 -m pip install -r requirements.txt --user
```

### 3. Verificar Modelo
Aseg√∫rate de que el modelo entrenado existe:
```
models/actions_15.keras
models/words.json
```

### 4. Verificar Configuraci√≥n
Revisa `config.yaml` para ajustar par√°metros si es necesario.

---

## üéØ Uso

### Iniciar el Servidor

#### Opci√≥n 1: Desde la carpeta backend
```powershell
cd web-app\backend
py -3.10 app.py
```

#### Opci√≥n 2: Desde la ra√≠z del proyecto
```powershell
py -3.10 web-app\backend\app.py
```

El servidor iniciar√° en: **http://localhost:5000**

### Acceder a la Aplicaci√≥n

1. **P√°gina Principal**: http://localhost:5000/
   - Informaci√≥n del proyecto
   - Caracter√≠sticas
   - Vocabulario disponible
   - Stack tecnol√≥gico

2. **Demo Interactivo**: http://localhost:5000/demo
   - Activar c√°mara web
   - Reconocimiento en tiempo real
   - Historial de predicciones
   - Estad√≠sticas de sesi√≥n

### Usar la Aplicaci√≥n

1. **Abrir Demo**: Navega a http://localhost:5000/demo

2. **Activar C√°mara**: 
   - Haz clic en "Activar C√°mara"
   - Permite acceso a la webcam cuando el navegador lo solicite

3. **Realizar Se√±as**:
   - Posici√≥nate frente a la c√°mara
   - Aseg√∫rate de que tu cuerpo y manos sean visibles
   - Realiza las se√±as del vocabulario LSP
   - La predicci√≥n aparecer√° autom√°ticamente

4. **Ver Resultados**:
   - Panel derecho muestra la predicci√≥n actual
   - Historial de √∫ltimas 10 se√±as reconocidas
   - Estad√≠sticas de la sesi√≥n (precisi√≥n, tiempo, cantidad)

---

## üìÅ Estructura del Proyecto

```
web-app/
‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îú‚îÄ‚îÄ app.py              # Servidor Flask + SocketIO
‚îÇ   ‚îî‚îÄ‚îÄ uploads/            # Carpeta para archivos temporales
‚îÇ
‚îú‚îÄ‚îÄ frontend/
‚îÇ   ‚îú‚îÄ‚îÄ index.html          # P√°gina principal
‚îÇ   ‚îú‚îÄ‚îÄ demo.html           # P√°gina de demo interactivo
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ css/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ styles.css      # Estilos principales
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ demo.css        # Estilos espec√≠ficos del demo
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ js/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ app.js          # JavaScript p√°gina principal
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ demo.js         # JavaScript demo (WebRTC + WebSocket)
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ assets/
‚îÇ       ‚îî‚îÄ‚îÄ images/         # Im√°genes y recursos
‚îÇ
‚îî‚îÄ‚îÄ README.md              # Este archivo
```

---

## üîå API Endpoints

### GET `/`
**Descripci√≥n**: P√°gina principal  
**Respuesta**: HTML de la landing page

### GET `/demo`
**Descripci√≥n**: P√°gina de demo interactivo  
**Respuesta**: HTML del demo con WebRTC

### GET `/api/health`
**Descripci√≥n**: Health check del servidor  
**Respuesta JSON**:
```json
{
  "status": "ok",
  "model_loaded": true,
  "vocabulary_size": 14,
  "words": ["hola", "adios", ...]
}
```

### GET `/api/vocabulary`
**Descripci√≥n**: Obtener vocabulario completo  
**Respuesta JSON**:
```json
{
  "vocabulary": {
    "hola": "HOLA",
    "adios": "ADI√ìS",
    ...
  },
  "total": 14
}
```

### POST `/api/predict-frame`
**Descripci√≥n**: Predecir desde un frame individual  
**Body**: 
```json
{
  "frame": "data:image/jpeg;base64,..."
}
```
**Respuesta**:
```json
{
  "has_hands": true,
  "keypoints_detected": {
    "pose": true,
    "face": true,
    "left_hand": true,
    "right_hand": false
  }
}
```

---

## üîå WebSocket Events

### Cliente ‚Üí Servidor

#### `process_frame`
Enviar frame para procesamiento en tiempo real
```javascript
socket.emit('process_frame', {
  frame: 'data:image/jpeg;base64,...'
});
```

#### `clear_sentence`
Limpiar historial de predicciones
```javascript
socket.emit('clear_sentence');
```

#### `reset_session`
Reiniciar sesi√≥n completa
```javascript
socket.emit('reset_session');
```

### Servidor ‚Üí Cliente

#### `connected`
Confirmaci√≥n de conexi√≥n establecida
```javascript
socket.on('connected', (data) => {
  console.log(data.message);
});
```

#### `status`
Actualizaci√≥n del estado de procesamiento
```javascript
socket.on('status', (data) => {
  // data.recording: boolean
  // data.frame_count: number
  // data.has_hands: boolean
});
```

#### `prediction`
Nueva predicci√≥n disponible
```javascript
socket.on('prediction', (data) => {
  // data.word: string (ej: "HOLA")
  // data.word_id: string (ej: "hola")
  // data.confidence: number (ej: 0.92)
  // data.sentence: array (√∫ltimas 5 palabras)
});
```

#### `error`
Error durante el procesamiento
```javascript
socket.on('error', (data) => {
  console.error(data.message);
});
```

---

## üé® Personalizaci√≥n

### Colores y Tema

Edita `frontend/css/styles.css` en la secci√≥n de variables CSS:

```css
:root {
    --primary: #6366f1;           /* Color primario */
    --secondary: #f59e0b;         /* Color secundario */
    --success: #10b981;           /* Color de √©xito */
    --danger: #ef4444;            /* Color de error */
    
    --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
}
```

### Configuraci√≥n del Servidor

Edita `backend/app.py`:

```python
# Cambiar host y puerto
socketio.run(app, 
             host='0.0.0.0',    # Cambiar a tu host
             port=5000,          # Cambiar puerto
             debug=True)         # False para producci√≥n
```

### Umbral de Confianza

Edita `config.yaml`:

```yaml
evaluation:
  confidence_threshold: 0.8  # Cambiar umbral (0.0 a 1.0)
```

---

## üîß Troubleshooting

### Problema: Servidor no inicia

**Error**: `ModuleNotFoundError: No module named 'flask_socketio'`

**Soluci√≥n**:
```powershell
py -3.10 -m pip install flask-socketio python-socketio --user
```

---

### Problema: Modelo no se carga

**Error**: `FileNotFoundError: models/actions_15.keras`

**Soluci√≥n**:
Aseg√∫rate de que el modelo existe en la ruta correcta:
```powershell
ls models/
# Debe mostrar: actions_15.keras, words.json
```

---

### Problema: C√°mara no se activa

**Error**: `NotAllowedError: Permission denied`

**Soluci√≥n**:
1. Verifica permisos del navegador para acceder a la c√°mara
2. Usa HTTPS en producci√≥n (WebRTC requiere conexi√≥n segura)
3. Comprueba que no hay otra app usando la c√°mara

---

### Problema: WebSocket no conecta

**Error**: `Socket.IO connection failed`

**Soluci√≥n**:
1. Verifica que el servidor est√© corriendo: http://localhost:5000
2. Comprueba la consola del navegador (F12) para errores
3. Verifica que el puerto 5000 no est√© bloqueado por firewall
4. Prueba desactivar extensiones del navegador (ej: AdBlock)

---

### Problema: Predicciones lentas

**S√≠ntomas**: Delay > 1 segundo entre frames

**Soluci√≥n**:
1. Reduce la resoluci√≥n de la c√°mara en `demo.js`:
```javascript
video: {
    width: { ideal: 640 },   // Reducir de 1280
    height: { ideal: 480 }   // Reducir de 720
}
```

2. Aumenta el intervalo de procesamiento:
```javascript
setTimeout(() => this.processFrames(), 50);  // De 33ms a 50ms
```

---

### Problema: Errores de CORS

**Error**: `CORS policy: No 'Access-Control-Allow-Origin' header`

**Soluci√≥n**:
Ya est√° configurado CORS en `app.py`. Si persiste:
```python
CORS(app, resources={r"/*": {"origins": "*"}})
```

---

## üìä M√©tricas de Performance

### Backend
- **Procesamiento por Frame**: ~30-50ms
- **Latencia WebSocket**: ~10-20ms
- **Memoria RAM**: ~500MB (modelo + MediaPipe)
- **CPU**: 15-25% (procesamiento continuo)

### Frontend
- **FPS de Video**: 30 fps
- **Carga Inicial**: ~2s
- **Bundle Size**: 
  - HTML: 15 KB
  - CSS: 25 KB
  - JS: 18 KB

---

## üîê Consideraciones de Seguridad

### Producci√≥n

1. **Deshabilitar Debug Mode**:
```python
socketio.run(app, debug=False)
```

2. **Usar HTTPS**:
```python
socketio.run(app, ssl_context='adhoc')  # Certificado temporal
# O usar certificados reales
```

3. **Limitar Tama√±o de Uploads**:
```python
app.config['MAX_CONTENT_LENGTH'] = 16 * 1024 * 1024  # 16MB
```

4. **Validar Inputs**:
```python
from werkzeug.utils import secure_filename
filename = secure_filename(file.filename)
```

5. **Rate Limiting**:
```python
from flask_limiter import Limiter
limiter = Limiter(app, default_limits=["100 per hour"])
```

---

## üìù Licencia

MIT License - Ver archivo `LICENSE` para m√°s detalles

---

## üë• Contribuir

1. Fork el proyecto
2. Crea una rama (`git checkout -b feature/amazing-feature`)
3. Commit cambios (`git commit -m 'feat: add amazing feature'`)
4. Push a la rama (`git push origin feature/amazing-feature`)
5. Abre un Pull Request

---

## üìû Soporte

¬øProblemas o preguntas?

- üìß Email: contact@lsp-project.com
- üí¨ GitHub Issues: [Crear Issue](https://github.com/tu-usuario/lsp-project/issues)
- üìñ Documentaci√≥n: Ver archivos en `/docs`

---

## üéâ Agradecimientos

- MediaPipe por la detecci√≥n de pose/manos
- TensorFlow por el framework de Deep Learning
- Flask y SocketIO por el backend en tiempo real
- Comunidad sorda peruana por el apoyo en LSP

---

**¬°Hecho con ‚ù§Ô∏è para la comunidad sorda peruana!**
